<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <header>
        
    </header>

    <section id="geoAPI">
        <h1>Geolocation API</h1>
        <button id="getPosition">Show Position</buttonf>

        <div id="position"></div>
       
    </section>
    
    <section>
        <h1>Json Bike-sharing Data set</h1>
        <div id="div1">
            <div id="link"></div>
            
            <table id="table1">
                <tr>
                    <th>Name</th>
                    <th>Ort</th>
                    <th>X-Koordinate</th>
                    <th>Y-Koordinate</th>
                    <th>Available Bikes</th>
                </tr>
                
            </table>
        </div>
       

        
    </section>
    
    
    
    <script>
        //Geolocation api

        var showPositionButton = document.getElementById("getPosition");
        showPositionButton.setAttribute("onclick", "getLocation()");

        var divPosition = document.getElementById("position");
        p = document.createElement("p");
       
        divPosition.appendChild(p);
        

        function getLocation() {
           
            navigator.geolocation.getCurrentPosition(showPosition);
  
        }

        function showPosition(position) {
             p.innerHTML = "Latitude: " + position.coords.latitude + 
             "<br>Longitude: " + position.coords.longitude; 
        }
      

       //Json
            var xmlhttp = new XMLHttpRequest();
            var url = "https://mobility.api.opendatahub.bz.it/v2/flat/BikesharingStation";

            var a = document.createElement("a");
        a.href = url;
    
            a.appendChild(document.createTextNode(url));
            var linkDiv = document.getElementById("link");
            linkDiv.appendChild(a);
       

            

            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4) {
                    var myArr = JSON.parse(this.responseText);
                    myFunction(myArr);
                }
            };
            xmlhttp.open("GET", url, true);
            xmlhttp.send();

            function myFunction(arr) {
                var out = "";
                var i;
                for (i = 0; i < arr.data.length; i++) {

                    var tabelle = document.getElementById("table1");
                    var tr = document.createElement("tr");
                    
                    var td1 = document.createElement("td");
                    var td2 = document.createElement("td");
                    var td3 = document.createElement("td");
                    var td4 = document.createElement("td");
                    var td5 = document.createElement("td");
                    var td6 = document.createElement("td");

                    td1.appendChild(document.createTextNode(arr.data[i].sname));
                    var td2Value;
                    if (arr.data[i].smetadata.municipality == undefined ) {
                        td2Value = arr.data[i].sorigin;
                    }
                    else {
                        td2Value = arr.data[i].smetadata.municipality;
                    }
                    td2.appendChild(document.createTextNode(td2Value));
                    td3.appendChild(document.createTextNode(arr.data[i].scoordinate.x));
                    td4.appendChild(document.createTextNode(arr.data[i].scoordinate.y));
                    td5.appendChild(document.createTextNode(arr.data[i].sorigin));
                    td6.appendChild(document.createTextNode(i));
                    

                    tr.appendChild(td1);
                    tr.appendChild(td2);
                    tr.appendChild(td3);
                    tr.appendChild(td4);
                    tr.appendChild(td5);
                    tr.appendChild(td6);
                   
                   
                    
                    tabelle.appendChild(tr)
                }

               
               
            }

            
            

        
        
        
    </script>
</body>
</html>